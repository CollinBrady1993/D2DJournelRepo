function [BLER] = PSDCHSINR2BLER(SINR,numTx)
%PSDCHSINR2BLER Summary of this function goes here
%   Detailed explanation goes here

%these values are taken from BLER Performance Evaluation of LTE 
%Device-to-Device Communications by Jian Wang and Richard Rouil
sinrFromNIST = [...
    -.8,-.6,-.4,-.2,0,.2,.4,.6,.8,1,1.2,1.4,1.6,1.8,2,2.2,2.4,2.6,2.8,3,3.2,3.4,3.6;...
    -4.4,-4.2,-4,-3.8,-3.6,-3.4,-3.2,-3,-2.8,-2.6,-2.4,-2.2,-2,-1.8,-1.6,-1.4,-1.2,-1,-.8,-.6,-.4,-.2,0;...
    -6.0,-5.8,-5.6,-5.4,-5.2,-5,-4.8,-4.6,-4.4,-4.2,-4,-3.8,-3.6,-3.4,-3.2,-3,-2.8,-2.6,-2.4,-2.2,-2,-1.8,-1.6;...
    -7.2,-7,-6.8,-6.6,-6.4,-6.2,-6.0,-5.8,-5.6,-5.4,-5.2,-5,-4.8,-4.6,-4.4,-4.2,-4,-3.8,-3.6,-3.4,-3.2,-3,-2.8];

blerFromNIST = [...
    1,0.9984,0.9972,0.9936,0.98,0.9524,0.9148,0.8192,0.7016,0.5628,0.3812,0.2616,0.1224,0.0708,0.0252,0.0108,0.0028,0,0,0,0,0,0;...
    1,0.9996,0.9996,0.9964,0.9908,0.9752,0.944,0.8692,0.7884,0.6448,0.47,0.2956,0.188,0.0828,0.0296,0.0136,0.0036,0.002,0.0004,0.0008,0,0,0;...
    1,0.9996,0.994,0.9888,0.974,0.9344,0.8676,0.7572,0.6104,0.4436,0.2816,0.1676,0.0704,0.034,0.012,0.0028,0.0016,0.0008,0.0004,0,0.0004,0.0004,0;...
    1,0.9988,0.9956,0.9896,0.9648,0.9332,0.8548,0.742,0.58,0.4272,0.2528,0.1384,0.0756,0.0248,0.0108,0.0032,0,0,0.0004,0,0,0,0];

BLER = zeros(length(SINR),1);
for i = 1:length(BLER)
    if SINR(i) < min(sinrFromNIST(numTx,:))
        BLER(i) = 1;
    elseif SINR(i) > max(sinrFromNIST(numTx,:))
        BLER(i) = 0;
    else
        BLER(i) = interp1(sinrFromNIST(numTx,:),blerFromNIST(numTx,:),SINR(i));
    end
end
end

